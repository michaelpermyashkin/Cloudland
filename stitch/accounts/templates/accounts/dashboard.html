<!-- Extends base template  -->
{% extends "store/base.html" %}
<!-- Loads static content to access content in static directory -->
{% load static %}
<!-- Page title for window tab -->
{% block page %}Dashboard{% endblock page%}
<!-- Custom style sheet -->
{% block styles %}{% endblock styles %}
<!-- fills content block in base template -->
{% block content %}
<div class="container" style="height: 100vh;">
    <div class="py-1 mt-5 text-center">
        <h2>My Account</h2>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-4 order-md-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
                <span class="text-muted">My cart</span>
                <span class="badge badge-success badge-pill">{{cart.cartitem_set.all|length}}</span>
            </h4>
            <ul class="list-group mb-3 rounded-0">
                {% for item in cart.cartitem_set.all %}
                <li class="list-group-item d-flex justify-content-between lh-condensed">
                    <div>
                        <h6 class="my-0">{{ item.product.product_name }} x {{ item.quantity }}</h6>
                        <small class="text-muted">{{ item.product.description_short }}</small>
                    </div>
                    <span class="text-muted">${{ item.line_total }}</span>
                </li>
                {% endfor %}
                <li class="list-group-item d-flex justify-content-between text-success">
                    <span>Total (USD)</span>
                    <h4>
                        <!-- Display cart total if exists -->
                        {% if cart.total %}
                        <b>${{ cart.total }}</b>
                        <!-- else display %0.00 -->
                        {% else %}
                        <b>$0.00</b>
                        <!--  -->
                        {% endif %}
                    </h4>
                </li>
            </ul>
        </div>
        <div class="col-md-8 order-md-1">
            <h3 class="text-center">My Orders</h3>
            <!-- Show order cards for user -->
            {% for order in user.order_set.all %}
            <div class="card rounded-0 mt-3">
                <div class="card-header">
                    <h5>Order #: {{ order.order_id }}</h5>
                </div>
                <div class="card-body p-2">
                    {% for item in order.cart.cartitem_set.all %}
                    <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                            <h6 class="my-0">{{ item.product.product_name }} x {{ item.quantity }}</h6>
                            <small class="text-muted">{{ item.product.description_short }}</small>
                        </div>
                        <span class="text-muted">${{ item.line_total }}</span>
                    </li>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <div class="text-right">
        <a href="{% url 'accounts-logout' %}" class="btn btn-danger mt-5">Logout</a>
    </div>
</div>
{%endblock content %}